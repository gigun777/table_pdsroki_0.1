* { box-sizing: border-box; }
html, body { margin: 0; background: #f6f7f8; overflow-x: hidden; }
.sdo-core-shell {
  display: grid;
  gap: 10px;
  align-items: start;
  justify-items: stretch;
  font-family: sans-serif;
  max-width: none;
  margin: 0;
  padding: 8px 10px;
  position: relative;
}

.sdo-navigation {
  display: flex;
  gap: 8px;
  width: 100%;
  align-items: center;
}
.sdo-nav-row {
  display: grid;
  grid-template-columns: 34px minmax(0, 1fr) minmax(0, 1fr) 34px;
  gap: 6px;
  align-items: center;
  flex: 1 1 0;
  min-width: 0;
}
.sdo-nav-btn {
  border: none;
  border-radius: 10px;
  background: #ececec;
  min-height: 34px;
  padding: 6px 8px;
  cursor: pointer;
  color: #111;
  min-width: 0;
}
.sdo-nav-btn:disabled { opacity: 0.45; cursor: default; }
.sdo-nav-main {
  background: #d8efdb;
  text-align: left;
  font-size: 12px;
  line-height: 1.15;
  white-space: normal;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}
.sdo-nav-plus { background: #ececec; font-size: 18px; }
.sdo-nav-back { background: #ececec; font-size: 16px; }

.sdo-toolbar { display: flex; justify-content: space-between; align-items: center; width: 100%; gap: 8px; }
.sdo-toolbar-left, .sdo-toolbar-right { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
.sdo-add-module,
.sdo-module-button {
  border: none;
  border-radius: 8px;
  background: #e9e9e9;
  padding: 6px 10px;
  cursor: pointer;
}

.sdo-panels, .sdo-settings {
  background: #fff;
  border-radius: 8px;
  min-height: 32px;
  width: 100%;
  padding: 8px;
}
.sdo-panel h3, .sdo-settings h4 { margin: 0 0 8px 0; font-size: 14px; }
.sdo-settings-row { display: grid; gap: 4px; margin-bottom: 8px; font-size: 12px; }
.sdo-settings-row input { border: 1px solid #bbb; border-radius: 6px; padding: 4px 6px; }
.sdo-status { color: #0f5132; font-size: 12px; justify-self: center; }

.sdo-modal-layer { position: fixed; inset: 0; z-index: 1000; }
.sdo-modal-layer[hidden] { display: none !important; }

/* Central modal styles */
.sdo-ui-modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.25);
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 12px;
}
.sdo-ui-modal-window {
  width: min(560px, 92vw);
  max-height: 85vh;
  background: #fff;
  border-radius: 14px;
  box-shadow: 0 15px 40px rgba(0,0,0,0.15);
  overflow: hidden;
}

.sdo-picker-modal {
  width: min(560px, 92vw);
  max-height: 72vh;
  overflow: auto;
  background: #fff;
  border-radius: 12px;
  padding: 12px;
  display: grid;
  gap: 8px;
}
.sdo-picker-title { font-weight: 600; }
.sdo-picker-list { display: grid; gap: 6px; }
.sdo-picker-row,
.sdo-picker-add,
.sdo-picker-close {
  border: none;
  border-radius: 8px;
  background: #efefef;
  min-height: 36px;
  text-align: left;
  padding: 0 10px;
  cursor: pointer;
}
.sdo-picker-row.is-selected { background: #d8efdb; }
.sdo-picker-add { background: #d8efdb; }
.sdo-template-details { padding: 8px; background: #f7f7f7; border-radius: 8px; font-size: 13px; }
.sdo-template-title { font-weight: 600; margin-bottom: 4px; }
.sdo-template-col { color: #333; margin: 2px 0; }
.sdo-template-actions { display: flex; gap: 8px; }

.sdo-settings-modal {
  width: min(1560px, 98vw);
  max-height: 94vh;
  background: #fff;
  border-radius: 14px;
  box-shadow: 0 15px 40px rgba(0,0,0,0.15);
  overflow: hidden;
  display: grid;
  grid-template-rows: auto minmax(0, 1fr);
  position: relative;
}

.sdo-settings-modal-title {
  padding: 14px 16px;
  border-bottom: 1px solid #e8e8e8;
  font-size: 16px;
  font-weight: 700;
}

.sdo-settings-modal-panes {
  display: grid;
  grid-template-columns: minmax(220px, 280px) minmax(240px, 320px) minmax(0, 1fr);
  min-height: 560px;
}

.sdo-settings-modal-nav,
.sdo-settings-modal-content {
  padding: 12px;
  min-height: 0;
  overflow: auto;
}

.sdo-settings-modal-nav {
  border-right: 1px solid #ededed;
  background: #fafafa;
}


.sdo-settings-modal-panes--patch4 {
  grid-template-columns: minmax(180px, 240px) minmax(220px, 320px) minmax(0, 1fr);
}

.sdo-settings-modal-feature-nav {
  padding: 12px;
  border-right: 1px solid #ededed;
  background: #f5f6f8;
  min-height: 0;
  overflow: auto;
}

.sdo-settings-feature-items,
.sdo-settings-nav-items {
  display: grid;
  gap: 8px;
}

.sdo-settings-feature-item,
.sdo-settings-nav-item {
  border: none;
  border-radius: 8px;
  background: #ececec;
  min-height: 36px;
  text-align: left;
  padding: 0 10px;
  cursor: pointer;
}

.sdo-settings-feature-item.is-active,
.sdo-settings-nav-item.is-active {
  background: #d8efdb;
}

.sdo-settings-pane-title {
  font-weight: 600;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}

.sdo-settings-content-title { margin-bottom: 0; }


.sdo-settings-modal-nav,
.sdo-settings-modal-content {
  display: grid;
  grid-template-rows: auto minmax(0, 1fr) auto;
  gap: 10px;
}

.sdo-settings-go-back-btn {
  min-width: 94px;
}

.sdo-settings-pane-footer {
  display: flex;
  justify-content: flex-end;
  align-items: center;
}

.sdo-settings-confirm-btn {
  min-width: 132px;
  text-align: center;
}

.sdo-settings-template-overlay-host {
  position: absolute;
  inset: 0;
  z-index: 5;
  display: grid;
  place-items: center;
  padding: 16px;
}

.sdo-settings-template-overlay-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.24);
}

.sdo-template-config-title {
  margin-bottom: 0;
}

.sdo-template-config-modal {
  position: relative;
  z-index: 1;
}

.sdo-settings-nav-list {
  display: grid;
  gap: 6px;
}

.sdo-settings-nav-item {
  border: none;
  border-radius: 8px;
  background: #ececec;
  min-height: 36px;
  text-align: left;
  padding: 0 10px;
  cursor: pointer;
}

.sdo-settings-nav-item.is-selected {
  background: #d8efdb;
}

.sdo-settings-section h3 {
  margin: 0 0 10px 0;
  font-size: 16px;
}

.sdo-settings-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 10px;
}

.sdo-settings-list {
  max-height: 52vh;
  overflow: auto;
}


.sdo-template-config-modal {
  width: min(580px, 92vw);
  max-height: 78vh;
  overflow: auto;
  background: #fff;
  border-radius: 12px;
  padding: 12px;
  display: grid;
  gap: 10px;
}

.sdo-template-config-fields {
  display: grid;
  gap: 8px;
}

@media (max-width: 900px) {
  .sdo-settings-modal {
    width: 100vw;
    height: 100vh;
    max-height: 100vh;
    border-radius: 0;
    position: fixed;
    inset: 0;
  }

  .sdo-settings-modal-title {
    padding: 16px;
  }

  .sdo-settings-modal-panes,
  .sdo-settings-modal-panes--patch4 {
    grid-template-columns: 1fr;
    position: relative;
    min-height: 0;
    height: calc(100vh - 57px);
  }

  .sdo-settings-modal-feature-nav,
  .sdo-settings-modal-nav,
  .sdo-settings-modal-content {
    grid-column: 1;
    grid-row: 1;
    border-right: none;
    background: #fff;
    padding: 14px;
  }

  .sdo-settings-modal.is-mobile-feature .sdo-settings-modal-nav,
  .sdo-settings-modal.is-mobile-feature .sdo-settings-modal-content {
    display: none;
  }

  .sdo-settings-modal.is-mobile-section .sdo-settings-modal-feature-nav,
  .sdo-settings-modal.is-mobile-section .sdo-settings-modal-content {
    display: none;
  }

  .sdo-settings-modal.is-mobile-content .sdo-settings-modal-feature-nav,
  .sdo-settings-modal.is-mobile-content .sdo-settings-modal-nav {
    display: none;
  }

  .sdo-settings-go-back-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

  .sdo-settings-pane-footer {
    padding-bottom: 2px;
  }

  .sdo-settings-template-overlay-host {
    padding: 0;
  }

  .sdo-template-config-modal {
    width: 100vw;
    height: 100vh;
    max-height: 100vh;
    border-radius: 0;
  }

}

.sdo-settings-modal-content{border-left:1px solid #ededed;}


/* UXUI feature (legacy-cleanup): basic layout */
.uxui-settings{ display:flex; flex-direction:column; gap:12px; padding:6px; }
.uxui-row{ display:grid; grid-template-columns: 220px minmax(0,1fr); gap:12px; align-items:center; }
.uxui-label{ font-size:13px; font-weight:600; }
.uxui-control{ display:flex; align-items:center; gap:10px; }
.uxui-select{ min-height:32px; padding:6px 10px; border-radius:10px; border:1px solid var(--border,#ddd); background:var(--panel,#fff); color:var(--text,#111); }
.uxui-hint{ grid-column: 1 / -1; font-size:12px; opacity:.75; margin-top:-6px; }


/* Settings modal: ensure 3rd content pane is visible */
.sdo-settings-modal{
  width: min(96vw, 980px);
  max-width: 980px;
}
.sdo-settings-modal-panes{
  grid-template-columns: minmax(200px, 260px) minmax(220px, 300px) minmax(320px, 1fr);
}
.sdo-settings-modal-content{
  background: var(--panel, #fff);
  border-left: 1px solid var(--border, #e5e5e5);
  min-width: 320px;
}
@media (max-width: 860px){
  .sdo-settings-modal{ width: min(96vw, 720px); max-width: 720px; }
  .sdo-settings-modal-panes{ grid-template-columns: 1fr; }
  .sdo-settings-modal-content{ min-width: 0; border-left:none; border-top:1px solid var(--border,#e5e5e5); }
}


/* FORCE 3-PANE SETTINGS LAYOUT (fix) */
.sdo-settings-modal{ width: min(96vw, 980px) !important; max-width: 980px !important; }
.sdo-settings-modal-panes{ display:grid !important; grid-template-columns: minmax(200px,260px) minmax(220px,300px) minmax(320px,1fr) !important; min-height: 560px; }
.sdo-settings-modal-feature-nav{ padding:12px; border-right:1px solid var(--border,#e5e5e5); background: rgba(0,0,0,0.03); overflow:auto; }
.sdo-settings-modal-nav{ padding:12px; overflow:auto; }
.sdo-settings-modal-content{ padding:12px; overflow:auto; border-left:1px solid var(--border,#e5e5e5); min-width:320px; background: var(--panel,#fff); }
@media (max-width: 860px){
  .sdo-settings-modal{ width: min(96vw, 720px) !important; max-width: 720px !important; }
  .sdo-settings-modal-panes{ grid-template-columns: 1fr !important; }
  .sdo-settings-modal-content{ border-left:none; border-top:1px solid var(--border,#e5e5e5); min-width:0; }
}

.sdo-open-settings-shell{display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:10px; border:1px solid var(--border,#ddd); background:var(--panel,#fff); color:var(--text,#111);}


/* UXUI modal (improve): scroll + footer */
.sdo-settings-section-window{ max-width: 820px; }
.uxui-settings{ display:flex; flex-direction:column; gap:12px; padding:10px; }
.uxui-header{ font-size:16px; font-weight:700; margin-bottom:4px; }
.uxui-body{ display:flex; flex-direction:column; gap:12px; max-height: 52vh; overflow:auto; padding-right:6px; }
.uxui-row{ display:grid; grid-template-columns: 220px minmax(0,1fr); gap:12px; align-items:center; }
.uxui-label{ font-size:13px; font-weight:600; }
.uxui-control{ display:flex; align-items:center; gap:10px; }
.uxui-select{ min-height:34px; padding:6px 10px; border-radius:10px; border:1px solid var(--border,#ddd); background:var(--panel,#fff); color:var(--text,#111); }
.uxui-toggle{ width:18px; height:18px; }
.uxui-hint{ grid-column: 1 / -1; font-size:12px; opacity:.75; margin-top:-6px; }
.uxui-footer{ position:sticky; bottom:0; display:flex; gap:10px; justify-content:flex-end; padding-top:10px; background: var(--panel,#fff); border-top:1px solid var(--border,#e5e5e5); }
.uxui-btn-primary{ font-weight:700; }


/* === UX|UI Pretty Pass (P1) === */
.sdo-ui-modal{
  width: min(96vw, 980px);
  max-width: 980px;
}
.sdo-ui-modal .sdo-ui-modal-content{
  max-height: 78vh;
  overflow: hidden;
  display:flex;
  flex-direction:column;
}
.sdo-ui-modal-title{
  font-size:16px;
  font-weight:700;
  padding: 4px 2px 10px 2px;
}

/* Section window wrapper inside modal */
.sdo-settings-section-window{
  display:flex;
  flex-direction:column;
  gap: 12px;
}

/* UXUI card */
.uxui-settings{
  border: 1px solid var(--border, #e5e5e5);
  border-radius: 14px;
  background: var(--panel, #fff);
  box-shadow: 0 6px 18px rgba(0,0,0,.06);
  overflow:hidden;
}
.uxui-header{
  padding: 14px 16px;
  font-size: 15px;
  font-weight: 800;
  border-bottom: 1px solid var(--border,#e5e5e5);
  background: rgba(0,0,0,0.02);
}
.uxui-body{
  padding: 14px 16px;
  max-height: 54vh;
  overflow:auto;
}
.uxui-row{
  grid-template-columns: minmax(180px, 260px) minmax(0, 1fr);
  padding: 10px 0;
  border-bottom: 1px dashed rgba(0,0,0,0.08);
}
.uxui-row:last-child{ border-bottom:none; }
.uxui-label{
  font-size: 13px;
  font-weight: 700;
}
.uxui-control{
  justify-content:flex-end;
}
.uxui-select{
  width: 240px;
  border-radius: 12px;
  outline: none;
}
.uxui-toggle{
  width: 20px;
  height: 20px;
}
.uxui-hint{
  opacity:.7;
  margin-top: 2px;
}

/* Footer actions */
.uxui-footer{
  padding: 12px 16px;
  background: var(--panel,#fff);
  border-top: 1px solid var(--border,#e5e5e5);
}
.uxui-btn{
  padding: 8px 12px;
  border-radius: 12px;
}
.uxui-btn-primary{
  padding: 8px 14px;
  border-radius: 12px;
}

/* Dark theme tune for UXUI card */
:root[data-theme="dark"] .uxui-settings{
  box-shadow: 0 10px 26px rgba(0,0,0,.25);
  border-color: rgba(255,255,255,0.12);
}
:root[data-theme="dark"] .uxui-header{
  background: rgba(255,255,255,0.04);
  border-bottom-color: rgba(255,255,255,0.10);
}
:root[data-theme="dark"] .uxui-row{
  border-bottom-color: rgba(255,255,255,0.10);
}
:root[data-theme="dark"] .uxui-select{
  border-color: rgba(255,255,255,0.16);
}


/* === Topbar Cleanup (P2-ish) === */
.sdo-core-shell{ display:flex; flex-direction:column; gap:10px; }
.sdo-toolbar{ display:flex; justify-content:space-between; align-items:center; padding:8px 10px; gap:10px; position:sticky; top:0; z-index:20; background: var(--bg, #fff); border-bottom:1px solid var(--border,#e5e5e5); }
.sdo-toolbar-left{ display:flex; align-items:center; gap:12px; min-width:0; flex:1; }
.sdo-toolbar-right{ display:flex; align-items:center; gap:8px; }
.sdo-icon-btn{ width:34px; height:34px; border-radius:10px; border:1px solid var(--border,#ddd); background: var(--panel,#fff); color: var(--text,#111); display:inline-flex; align-items:center; justify-content:center; cursor:pointer; }
.sdo-icon-btn:hover{ filter: brightness(0.98); }
:root[data-theme="dark"] .sdo-icon-btn{ border-color: rgba(255,255,255,.14); }

/* Navigation in one row */
.sdo-navigation{ display:flex; gap:10px; align-items:center; min-width:0; }
.sdo-nav-row{ display:flex; gap:6px; align-items:center; }
.sdo-nav-btn{ height:34px; border-radius:12px; border:1px solid var(--border,#ddd); background: var(--panel,#fff); padding:0 10px; font-size:12px; line-height:1.1; white-space:normal; }
.sdo-nav-btn.sdo-nav-current{ width:180px; max-width:180px; overflow:hidden; text-overflow:ellipsis; display:flex; align-items:center; justify-content:center; text-align:center; }
.sdo-nav-btn.sdo-nav-children{ width:180px; max-width:180px; overflow:hidden; text-overflow:ellipsis; }
.sdo-nav-btn.sdo-nav-back, .sdo-nav-btn.sdo-nav-plus{ width:34px; padding:0; display:flex; align-items:center; justify-content:center; }

/* Table controls moved to header */
.sdo-table-toolbar-host{ display:flex; align-items:center; gap:8px; min-width:0; flex:1; }
.sdo-table-controls.sdo-table-controls-inline{ display:flex !important; gap:8px; align-items:center; }
.sdo-table-controls-inline input[type="text"], .sdo-table-controls-inline input{ height:34px; border-radius:12px; border:1px solid var(--border,#ddd); padding:0 10px; min-width:220px; }
.sdo-table-controls-inline button{ height:34px; border-radius:12px; border:1px solid var(--border,#ddd); background: var(--panel,#fff); padding:0 12px; font-size:12px; cursor:pointer; }


/* === Topbar single-row tightening === */
.sdo-toolbar-left{ flex-wrap: nowrap; }
.sdo-navigation{ flex: 0 0 auto; }
.sdo-table-toolbar-host{ flex: 1 1 auto; min-width: 0; justify-content:flex-start; }
.sdo-table-controls-inline{ flex-wrap: nowrap; min-width:0; }
.sdo-table-controls-inline input[type="text"], .sdo-table-controls-inline input{
  min-width: 140px;
  max-width: 320px;
  width: 22vw;
}
.sdo-nav-btn.sdo-nav-current,
.sdo-nav-btn.sdo-nav-children{ width:155px; max-width:155px; }


/* === Topbar Layout Fix (fix4) === */
.sdo-toolbar-left{
  justify-content: flex-start;
  gap: 14px;
}
.sdo-navigation{
  justify-content: flex-start !important;
  flex: 0 0 auto;
  min-width: 0;
}
.sdo-nav-row{
  justify-content: flex-start;
}
.sdo-table-toolbar-host{
  flex: 0 1 auto;
  min-width: 0;
  margin-left: 6px;
}
.sdo-table-controls-inline{
  justify-content: flex-start;
}
.sdo-toolbar-right{
  margin-left: auto;
}
/* Make navigation groups stick together (spaces -> journals) */
.sdo-navigation .sdo-nav-row + .sdo-nav-row{
  margin-left: 12px;
}
/* Prevent right-side pile-up */
.sdo-toolbar-right .sdo-icon-btn{ flex: 0 0 auto; }


/* === Topbar Blocks Layout (fix5) === */
.sdo-toolbar{ padding: 6px 8px; }
.sdo-toolbar-left{ align-items: flex-start; gap: 10px; justify-content:flex-start; }
.sdo-block{ display:flex; align-items:center; gap:8px; }
.sdo-block-nav{ align-items:flex-start; }
.sdo-toolbar-right{ margin-left:auto; justify-content:flex-end; align-items:flex-start; }
.sdo-block-settings{ align-items:center; }

/* Navigation: spaces then journals */
.sdo-navigation{ display:flex; gap:10px; align-items:center; }
.sdo-navigation .sdo-nav-row{ display:flex; gap:6px; align-items:center; flex-wrap:nowrap; }
.sdo-navigation .sdo-nav-row + .sdo-nav-row{ margin-left: 10px; }

/* Table controls to the right of journals */
.sdo-table-toolbar-host{ display:flex; align-items:center; gap:8px; flex-wrap:nowrap; }
.sdo-table-controls-inline{ flex-wrap:nowrap; }

/* Fixed nav widths */
.sdo-nav-btn.sdo-nav-current, .sdo-nav-btn.sdo-nav-children{ width: 155px; max-width:155px; }

/* Keep one line */
.sdo-toolbar-left, .sdo-navigation, .sdo-nav-row, .sdo-table-toolbar-host{ flex-wrap:nowrap; }


/* === Table borders enabled (fix6) === */
.sdo-table table{ border-collapse: collapse; }
.sdo-table th, .sdo-table td{ border: 1px solid var(--border,#d9d9d9); }
:root[data-theme="dark"] .sdo-table th,
:root[data-theme="dark"] .sdo-table td{ border-color: rgba(255,255,255,0.14); }


/* === Table layout + scrolling (fix7) === */
html, body { height: 100%; }
.sdo-root, .sdo-core-shell{ height: 100vh; }
.sdo-panels{ flex: 1 1 auto; overflow: hidden; padding: 8px; }
.sdo-panel{ height: 100%; overflow: hidden; }
.sdo-table-panel{ height: 100%; display:flex; flex-direction:column; gap:8px; }
.sdo-table-scroll{ flex: 1 1 auto; overflow: auto; overscroll-behavior: contain; border-radius: 10px; }
.sdo-table{ width: max-content; min-width: 100%; table-layout: auto; }
.sdo-table th, .sdo-table td{ text-align:center; vertical-align: middle; white-space: nowrap; }


/* === Modal overlay above header (fix8) === */
.sdo-modal-overlay{ z-index: 1000 !important; }
.sdo-modal{ z-index: 1001 !important; }
.sdo-toolbar{ z-index: 20; }


/* === Force table cell centering (fix8) === */
.sdo-table td{ text-align:center !important; }
